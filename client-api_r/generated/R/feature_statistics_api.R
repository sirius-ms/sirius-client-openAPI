#' SIRIUS Nightsky API
#'
#' REST API that provides the full functionality of SIRIUS and its web services as background service. It is intended as entry-point for scripting languages and software integration SDKs.This API is exposed by SIRIUS 6
#'
#' The version of the OpenAPI document: 3.1
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title FeatureStatistics operations
#' @description FeatureStatisticsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @examples
#' \dontrun{
#' ####################  ComputeAlignedFeatureFoldChangesExperimental  ####################
#'
#' library(Rsirius)
#' var_project_id <- "project_id_example" # character | project-space to compute the fold change in.
#' var_left_group_name <- "left_group_name_example" # character | name of the left tag group.
#' var_right_group_name <- "right_group_name_example" # character | name of the right tag group.
#' var_aggregation <- "AVG" # character | aggregation type. (Optional)
#' var_quantification <- "APEX_INTENSITY" # character | quantification type. (Optional)
#' var_opt_fields <- c("none") # array[character] | job opt fields. (Optional)
#'
#' #[EXPERIMENTAL] Compute the fold change between two groups of runs
#' api_instance <- rsirius_api$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$ComputeAlignedFeatureFoldChangesExperimental(var_project_id, var_left_group_name, var_right_group_name, aggregation = var_aggregation, quantification = var_quantification, opt_fields = var_opt_fieldsdata_file = "result.txt")
#' result <- api_instance$feature_statistics_api$ComputeAlignedFeatureFoldChangesExperimental(var_project_id, var_left_group_name, var_right_group_name, aggregation = var_aggregation, quantification = var_quantification, opt_fields = var_opt_fields)
#' dput(result)
#'
#'
#' ####################  DeleteAlignedFeatureFoldChangesExperimental  ####################
#'
#' library(Rsirius)
#' var_project_id <- "project_id_example" # character | project-space to delete from.
#' var_left_group_name <- "left_group_name_example" # character | name of the left group.
#' var_right_group_name <- "right_group_name_example" # character | name of the right group.
#' var_aggregation <- "AVG" # character |  (Optional)
#' var_quantification <- "APEX_INTENSITY" # character |  (Optional)
#'
#' #[EXPERIMENTAL] Delete fold changes
#' api_instance <- rsirius_api$new()
#'
#' api_instance$feature_statistics_api$DeleteAlignedFeatureFoldChangesExperimental(var_project_id, var_left_group_name, var_right_group_name, aggregation = var_aggregation, quantification = var_quantification)
#'
#'
#' ####################  GetAlignedFeatureFoldChangeTableExperimental  ####################
#'
#' library(Rsirius)
#' var_project_id <- "project_id_example" # character | project-space to read from.
#' var_aggregation <- "AVG" # character | aggregation type. (Optional)
#' var_quantification <- "APEX_INTENSITY" # character | quantification type. (Optional)
#'
#' #[EXPERIMENTAL] Get table of all fold changes in the project space
#' api_instance <- rsirius_api$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$GetAlignedFeatureFoldChangeTableExperimental(var_project_id, aggregation = var_aggregation, quantification = var_quantificationdata_file = "result.txt")
#' result <- api_instance$feature_statistics_api$GetAlignedFeatureFoldChangeTableExperimental(var_project_id, aggregation = var_aggregation, quantification = var_quantification)
#' dput(result)
#'
#'
#' ####################  GetFoldChangesByAlignedFeatureExperimental  ####################
#'
#' library(Rsirius)
#' var_project_id <- "project_id_example" # character | project-space to read from.
#' var_object_id <- "object_id_example" # character | id of the object the fold changes are assigned to.
#'
#' #[EXPERIMENTAL] List all fold changes that are associated with an object
#' api_instance <- rsirius_api$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$GetFoldChangesByAlignedFeatureExperimental(var_project_id, var_object_iddata_file = "result.txt")
#' result <- api_instance$feature_statistics_api$GetFoldChangesByAlignedFeatureExperimental(var_project_id, var_object_id)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
FeatureStatisticsApi <- R6::R6Class(
  "FeatureStatisticsApi",
  public = list(
    api_client = NULL,

    #' @description
    #' Initialize a new FeatureStatisticsApi.
    #'
    #' @param api_client An instance of API client.
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },

    #' @description
    #' [EXPERIMENTAL] Compute the fold change between two groups of runs
    #'
    #' @param project_id project-space to compute the fold change in.
    #' @param left_group_name name of the left tag group.
    #' @param right_group_name name of the right tag group.
    #' @param aggregation (optional) aggregation type. (default value: "AVG")
    #' @param quantification (optional) quantification type. (default value: "APEX_INTENSITY")
    #' @param opt_fields (optional) job opt fields. (default value: [progress])
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return Job
    ComputeAlignedFeatureFoldChangesExperimental = function(project_id, left_group_name, right_group_name, aggregation = "AVG", quantification = "APEX_INTENSITY", opt_fields = list(progress), data_file = NULL, ...) {
      local_var_response <- self$ComputeAlignedFeatureFoldChangesExperimentalWithHttpInfo(project_id, left_group_name, right_group_name, aggregation, quantification, opt_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' [EXPERIMENTAL] Compute the fold change between two groups of runs
    #'
    #' @param project_id project-space to compute the fold change in.
    #' @param left_group_name name of the left tag group.
    #' @param right_group_name name of the right tag group.
    #' @param aggregation (optional) aggregation type. (default value: "AVG")
    #' @param quantification (optional) quantification type. (default value: "APEX_INTENSITY")
    #' @param opt_fields (optional) job opt fields. (default value: [progress])
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (Job) with additional information such as HTTP status code, headers
    ComputeAlignedFeatureFoldChangesExperimentalWithHttpInfo = function(project_id, left_group_name, right_group_name, aggregation = "AVG", quantification = "APEX_INTENSITY", opt_fields = list(progress), data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`project_id`)) {
        stop("Missing required parameter `project_id`.")
      }

      if (missing(`left_group_name`)) {
        stop("Missing required parameter `left_group_name`.")
      }

      if (missing(`right_group_name`)) {
        stop("Missing required parameter `right_group_name`.")
      }







      query_params[["leftGroupName"]] <- `left_group_name`

      query_params[["rightGroupName"]] <- `right_group_name`

      if (!is.null(`aggregation`) && !(`aggregation` %in% c("AVG", "MIN", "MAX"))) {
        stop("Invalid value for aggregation when calling FeatureStatisticsApi$ComputeAlignedFeatureFoldChangesExperimental. Must be [AVG, MIN, MAX].")
      }
      query_params[["aggregation"]] <- `aggregation`

      if (!is.null(`quantification`) && !(`quantification` %in% c("APEX_INTENSITY", "AREA_UNDER_CURVE"))) {
        stop("Invalid value for quantification when calling FeatureStatisticsApi$ComputeAlignedFeatureFoldChangesExperimental. Must be [APEX_INTENSITY, AREA_UNDER_CURVE].")
      }
      query_params[["quantification"]] <- `quantification`

      # explore
      for (query_item in `opt_fields`) {
        # validate enum values
        if (!is.null(query_item) && !(query_item %in% c("none", "command", "progress", "affectedIds"))) {
          stop("Invalid value for opt_fields when calling FeatureStatisticsApi$ComputeAlignedFeatureFoldChangesExperimental. Must be [none, command, progress, affectedIds].")
        }
        query_params[["optFields"]] <- c(query_params[["optFields"]], list(`optFields` = query_item))
      }

      local_var_url_path <- "/api/projects/{projectId}/aligned-features/statistics/foldchange/compute"
      if (!missing(`project_id`)) {
        local_var_url_path <- gsub("\\{projectId\\}", URLencode(as.character(`project_id`), reserved = TRUE), local_var_url_path)
      }


      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "PUT",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "Job"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' [EXPERIMENTAL] Delete fold changes
    #'
    #' @param project_id project-space to delete from.
    #' @param left_group_name name of the left group.
    #' @param right_group_name name of the right group.
    #' @param aggregation (optional) No description (default value: "AVG")
    #' @param quantification (optional) No description (default value: "APEX_INTENSITY")
    #' @param ... Other optional arguments
    #'
    #' @return void
    DeleteAlignedFeatureFoldChangesExperimental = function(project_id, left_group_name, right_group_name, aggregation = "AVG", quantification = "APEX_INTENSITY", ...) {
      local_var_response <- self$DeleteAlignedFeatureFoldChangesExperimentalWithHttpInfo(project_id, left_group_name, right_group_name, aggregation, quantification, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' [EXPERIMENTAL] Delete fold changes
    #'
    #' @param project_id project-space to delete from.
    #' @param left_group_name name of the left group.
    #' @param right_group_name name of the right group.
    #' @param aggregation (optional) No description (default value: "AVG")
    #' @param quantification (optional) No description (default value: "APEX_INTENSITY")
    #' @param ... Other optional arguments
    #'
    #' @return API response (void) with additional information such as HTTP status code, headers
    DeleteAlignedFeatureFoldChangesExperimentalWithHttpInfo = function(project_id, left_group_name, right_group_name, aggregation = "AVG", quantification = "APEX_INTENSITY", ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`project_id`)) {
        stop("Missing required parameter `project_id`.")
      }

      if (missing(`left_group_name`)) {
        stop("Missing required parameter `left_group_name`.")
      }

      if (missing(`right_group_name`)) {
        stop("Missing required parameter `right_group_name`.")
      }






      query_params[["leftGroupName"]] <- `left_group_name`

      query_params[["rightGroupName"]] <- `right_group_name`

      if (!is.null(`aggregation`) && !(`aggregation` %in% c("AVG", "MIN", "MAX"))) {
        stop("Invalid value for aggregation when calling FeatureStatisticsApi$DeleteAlignedFeatureFoldChangesExperimental. Must be [AVG, MIN, MAX].")
      }
      query_params[["aggregation"]] <- `aggregation`

      if (!is.null(`quantification`) && !(`quantification` %in% c("APEX_INTENSITY", "AREA_UNDER_CURVE"))) {
        stop("Invalid value for quantification when calling FeatureStatisticsApi$DeleteAlignedFeatureFoldChangesExperimental. Must be [APEX_INTENSITY, AREA_UNDER_CURVE].")
      }
      query_params[["quantification"]] <- `quantification`

      local_var_url_path <- "/api/projects/{projectId}/aligned-features/statistics/foldchanges"
      if (!missing(`project_id`)) {
        local_var_url_path <- gsub("\\{projectId\\}", URLencode(as.character(`project_id`), reserved = TRUE), local_var_url_path)
      }


      # The Accept request HTTP header
      local_var_accepts <- list()

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        local_var_resp$content <- NULL
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' [EXPERIMENTAL] Get table of all fold changes in the project space
    #'
    #' @param project_id project-space to read from.
    #' @param aggregation (optional) aggregation type. (default value: "AVG")
    #' @param quantification (optional) quantification type. (default value: "APEX_INTENSITY")
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return StatisticsTable
    GetAlignedFeatureFoldChangeTableExperimental = function(project_id, aggregation = "AVG", quantification = "APEX_INTENSITY", data_file = NULL, ...) {
      local_var_response <- self$GetAlignedFeatureFoldChangeTableExperimentalWithHttpInfo(project_id, aggregation, quantification, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' [EXPERIMENTAL] Get table of all fold changes in the project space
    #'
    #' @param project_id project-space to read from.
    #' @param aggregation (optional) aggregation type. (default value: "AVG")
    #' @param quantification (optional) quantification type. (default value: "APEX_INTENSITY")
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (StatisticsTable) with additional information such as HTTP status code, headers
    GetAlignedFeatureFoldChangeTableExperimentalWithHttpInfo = function(project_id, aggregation = "AVG", quantification = "APEX_INTENSITY", data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`project_id`)) {
        stop("Missing required parameter `project_id`.")
      }




      if (!is.null(`aggregation`) && !(`aggregation` %in% c("AVG", "MIN", "MAX"))) {
        stop("Invalid value for aggregation when calling FeatureStatisticsApi$GetAlignedFeatureFoldChangeTableExperimental. Must be [AVG, MIN, MAX].")
      }
      query_params[["aggregation"]] <- `aggregation`

      if (!is.null(`quantification`) && !(`quantification` %in% c("APEX_INTENSITY", "AREA_UNDER_CURVE"))) {
        stop("Invalid value for quantification when calling FeatureStatisticsApi$GetAlignedFeatureFoldChangeTableExperimental. Must be [APEX_INTENSITY, AREA_UNDER_CURVE].")
      }
      query_params[["quantification"]] <- `quantification`

      local_var_url_path <- "/api/projects/{projectId}/aligned-features/statistics/foldchanges/stats-table"
      if (!missing(`project_id`)) {
        local_var_url_path <- gsub("\\{projectId\\}", URLencode(as.character(`project_id`), reserved = TRUE), local_var_url_path)
      }


      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "StatisticsTable"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' [EXPERIMENTAL] List all fold changes that are associated with an object
    #'
    #' @param project_id project-space to read from.
    #' @param object_id id of the object the fold changes are assigned to.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return array[FoldChange]
    GetFoldChangesByAlignedFeatureExperimental = function(project_id, object_id, data_file = NULL, ...) {
      local_var_response <- self$GetFoldChangesByAlignedFeatureExperimentalWithHttpInfo(project_id, object_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' [EXPERIMENTAL] List all fold changes that are associated with an object
    #'
    #' @param project_id project-space to read from.
    #' @param object_id id of the object the fold changes are assigned to.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (array[FoldChange]) with additional information such as HTTP status code, headers
    GetFoldChangesByAlignedFeatureExperimentalWithHttpInfo = function(project_id, object_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`project_id`)) {
        stop("Missing required parameter `project_id`.")
      }

      if (missing(`object_id`)) {
        stop("Missing required parameter `object_id`.")
      }



      local_var_url_path <- "/api/projects/{projectId}/aligned-features/statistics/foldchanges/{objectId}"
      if (!missing(`project_id`)) {
        local_var_url_path <- gsub("\\{projectId\\}", URLencode(as.character(`project_id`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`object_id`)) {
        local_var_url_path <- gsub("\\{objectId\\}", URLencode(as.character(`object_id`), reserved = TRUE), local_var_url_path)
      }


      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "array[FoldChange]"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    }
  )
)
