# Automatically generated by openapi-generator (https://openapi-generator.tech)
# Please update as you see appropriate

context("Test SearchableDatabasesApi")

sdk <- SiriusSDK$new()
api <- sdk$attach_to_sirius(sirius_port=8080)
api_instance <- api$searchable_databases_api
home_dir <- Sys.getenv("HOME")
path_to_demo_data <- paste(home_dir, "sirius-client-openAPI/.updater/clientTests/Data", sep = "/")
test_file <- paste(path_to_demo_data, "Kaempferol.ms", sep = "/")


test_that("CreateDatabase", {
  # tests for CreateDatabase
  # base path: http://localhost:8080
  # @param database_id character 
  # @param searchable_database_parameters SearchableDatabaseParameters  (optional)
  # @return [SearchableDatabase]

  tryCatch({

    db_name <- "CreateDatabase"
    db_params <- SearchableDatabaseParameters$new(display_name = db_name, location = paste0(home_dir, "/", db_name, ".siriusdb"))

    response <- api_instance$CreateDatabase(db_name, db_params)
    expect_true(inherits(response, "SearchableDatabase"))

  }, finally = {

    api_instance$RemoveDatabase(db_name, TRUE)

  })
})

test_that("GetCustomDatabases", {
  # tests for GetCustomDatabases
  # base path: http://localhost:8080
  # @param include_stats character  (optional)
  # @return [array[SearchableDatabase]]

  tryCatch({

    db_name <- "GetCustomDatabases"
    db_params <- SearchableDatabaseParameters$new(display_name = db_name, location = paste0(home_dir, "/", db_name, ".siriusdb"))
    api_instance$CreateDatabase(db_name, db_params)

    response <- api_instance$GetCustomDatabases()
    expect_true(inherits(response, "list"))
    expect_true(inherits(response[[1]], "SearchableDatabase"))

  }, finally = {

    api_instance$RemoveDatabase(db_name, TRUE)

  })
})

test_that("GetDatabase", {
  # tests for GetDatabase
  # base path: http://localhost:8080
  # @param database_id character 
  # @param include_stats character  (optional)
  # @return [SearchableDatabase]

  tryCatch({

    db_name <- "GetDatabase"
    db_params <- SearchableDatabaseParameters$new(display_name = db_name, location = paste0(home_dir, "/", db_name, ".siriusdb"))
    api_instance$CreateDatabase(db_name, db_params)

    response <- api_instance$GetDatabase(db_name)
    expect_true(inherits(response, "SearchableDatabase"))

  }, finally = {

    api_instance$RemoveDatabase(db_name, TRUE)

  })
})

test_that("GetDatabases", {
  # tests for GetDatabases
  # base path: http://localhost:8080
  # @param include_stats character  (optional)
  # @return [array[SearchableDatabase]]

  response <- api_instance$GetIncludedDatabases()
  expect_true(inherits(response, "list"))
  expect_true(inherits(response[[1]], "SearchableDatabase"))
})

test_that("GetIncludedDatabases", {
  # tests for GetIncludedDatabases
  # base path: http://localhost:8080
  # @param include_stats character  (optional)
  # @return [array[SearchableDatabase]]

  response <- api_instance$GetIncludedDatabases()
  expect_true(inherits(response, "list"))
  expect_true(inherits(response[[1]], "SearchableDatabase"))
})

test_that("ImportIntoDatabase", {
  # tests for ImportIntoDatabase
  # base path: http://localhost:8080
  # Start import of structure and spectra files into the specified database.
  # Start import of structure and spectra files into the specified database.
  # @param database_id character database to import into
  # @param buffer_size integer  (optional)
  # @param input_files array[data.frame]  (optional)
  # @return [SearchableDatabase]

  tryCatch({

    db_name <- "ImportIntoDatabase"
    db_params <- SearchableDatabaseParameters$new(display_name = db_name, location = paste0(home_dir, "/", db_name, ".siriusdb"))
    api_instance$CreateDatabase(db_name, db_params)

    response <- api_instance$ImportIntoDatabase(db_name, input_files = c(test_file))
    expect_true(inherits(response, "SearchableDatabase"))

  }, finally = {

    api_instance$RemoveDatabase(db_name, TRUE)

  })
})

test_that("RemoveDatabase", {
  # tests for RemoveDatabase
  # base path: http://localhost:8080
  # @param database_id character 
  # @param delete character  (optional)
  # @return [Void]

  db_name <- "RemoveDatabase"
  db_params <- SearchableDatabaseParameters$new(display_name = db_name, location = paste0(home_dir, "/", db_name, ".siriusdb"))
  api_instance$CreateDatabase(db_name, db_params)

  response <- api_instance$RemoveDatabase(db_name, TRUE)

  expect_true(is.null(response))
})

test_that("UpdateDatabase", {
  # tests for UpdateDatabase
  # base path: http://localhost:8080
  # @param database_id character 
  # @param searchable_database_parameters SearchableDatabaseParameters  (optional)
  # @return [SearchableDatabase]

#   # TODO java.lang.UnsupportedOperationException: Updating Custom databases is not yest supported
#   db_name <- "UpdateDatabase"
#   api_instance$CreateDatabase(db_name)
#
#   response <- api_instance$UpdateDatabase(db_name)
#
#   expect_true(inherits(response, "SearchableDatabase"))
})
